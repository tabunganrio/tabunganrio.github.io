</div>

    <!-- MODAL CHANGE PASSWORD -->
    <div id="changePasswordModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 2000; justify-content: center; align-items: center;">
        <div style="background: rgba(15, 25, 50, 0.95); border: 2px solid rgba(0, 255, 255, 0.5); padding: 40px; border-radius: 20px; width: 90%; max-width: 450px; backdrop-filter: blur(20px);">
            <h2 style="font-family: 'Orbitron'; color: #ff00ff; margin-bottom: 20px; font-size: 18px;">üîë Change Password</h2>
            
            <div class="error-message" id="passErrorMsg"></div>
            <div class="success-message" id="passSuccessMsg"></div>

            <div class="form-group">
                <label>Current Password</label>
                <input type="password" id="currentPass" placeholder="Enter current password">
            </div>
            <div class="form-group">
                <label>New Password</label>
                <input type="password" id="newPass" placeholder="Enter new password">
            </div>
            <div class="form-group">
                <label>Confirm New Password</label>
                <input type="password" id="confirmNewPass" placeholder="Confirm new password">
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <button class="btn-primary" onclick="changePassword()" style="background: linear-gradient(135deg, #00ff88, #00cc6f);">‚úÖ UPDATE</button>
                <button class="btn-primary" onclick="closeChangePassword()" style="background: linear-gradient(135deg, #ff0055, #cc0044);">‚ùå CANCEL</button>
            </div>
        </div>
    </div>

    <script><!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tabungan Digital Futuristik</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;600;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Rajdhani', sans-serif;
            background: #0a0e27;
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            background: 
                radial-gradient(circle at 20% 50%, rgba(0, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(138, 43, 226, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, rgba(255, 0, 255, 0.1) 0%, transparent 50%);
            animation: bgPulse 10s ease-in-out infinite;
        }

        @keyframes bgPulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.6; }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        .login-screen {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            position: relative;
            z-index: 1;
        }

        .login-box {
            background: rgba(15, 25, 50, 0.95);
            border: 2px solid rgba(0, 255, 255, 0.5);
            padding: 50px;
            border-radius: 20px;
            width: 100%;
            max-width: 450px;
            backdrop-filter: blur(20px);
            box-shadow: 0 20px 60px rgba(0, 255, 255, 0.3);
        }

        .login-box h2 {
            font-family: 'Orbitron', sans-serif;
            font-size: 36px;
            text-align: center;
            background: linear-gradient(90deg, #00ffff, #ff00ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .login-box .subtitle {
            text-align: center;
            color: #00ffff;
            font-size: 14px;
            letter-spacing: 2px;
            margin-bottom: 40px;
            text-transform: uppercase;
        }

        .tab-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 30px;
        }

        .tab-btn {
            padding: 12px;
            border: 2px solid rgba(0, 255, 255, 0.3);
            background: transparent;
            color: #00ffff;
            font-family: 'Orbitron', sans-serif;
            font-size: 14px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
        }

        .tab-btn.active {
            background: rgba(0, 255, 255, 0.2);
            border-color: #00ffff;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #00ffff;
            font-weight: 600;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid rgba(0, 255, 255, 0.3);
            border-radius: 10px;
            font-size: 14px;
            background: rgba(10, 14, 39, 0.8);
            color: #fff;
            font-family: 'Rajdhani', sans-serif;
            transition: all 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #00ffff;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
        }

        .btn-primary {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
            letter-spacing: 1px;
            background: linear-gradient(135deg, #00ffff, #00cccc);
            color: #000;
            transition: all 0.3s;
            box-shadow: 0 5px 20px rgba(0, 255, 255, 0.4);
            margin-top: 10px;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 255, 255, 0.6);
        }

        .error-message, .success-message {
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
            display: none;
            font-size: 13px;
        }

        .error-message {
            background: rgba(255, 0, 85, 0.2);
            border: 1px solid #ff0055;
            color: #ff0055;
        }

        .success-message {
            background: rgba(0, 255, 136, 0.2);
            border: 1px solid #00ff88;
            color: #00ff88;
        }

        .main-app {
            display: none;
        }

        header {
            background: rgba(15, 25, 50, 0.9);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 25px;
            border: 2px solid rgba(0, 255, 255, 0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .header-left h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 28px;
            background: linear-gradient(90deg, #00ffff, #ff00ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-info {
            font-family: 'Orbitron', sans-serif;
            color: #00ff88;
            font-size: 14px;
            padding: 8px 15px;
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid rgba(0, 255, 136, 0.3);
            border-radius: 10px;
        }

        button {
            padding: 10px 15px;
            border: none;
            border-radius: 10px;
            font-family: 'Orbitron', sans-serif;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
        }

        .btn-logout {
            background: linear-gradient(135deg, #ff0055, #cc0044);
            color: #fff;
            box-shadow: 0 5px 20px rgba(255, 0, 85, 0.4);
        }

        .btn-logout:hover {
            transform: translateY(-2px);
        }

        .balance-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .card {
            background: rgba(15, 25, 50, 0.8);
            border: 2px solid rgba(0, 255, 255, 0.3);
            padding: 25px;
            border-radius: 15px;
            position: relative;
            overflow: hidden;
        }

        .card h3 {
            color: #00ffff;
            font-size: 12px;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .card .amount {
            font-family: 'Orbitron', sans-serif;
            font-size: 28px;
            font-weight: 700;
        }

        .card.income .amount { color: #00ff88; }
        .card.expense .amount { color: #ff0055; }
        .card.balance .amount { color: #00ffff; }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .tab-link {
            padding: 10px 20px;
            background: rgba(15, 25, 50, 0.9);
            border: 2px solid rgba(0, 255, 255, 0.3);
            color: #00ffff;
            border-radius: 8px;
            cursor: pointer;
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
            font-size: 12px;
            transition: all 0.3s;
        }

        .tab-link.active {
            background: rgba(0, 255, 255, 0.2);
            border-color: #00ffff;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .panel {
            background: rgba(15, 25, 50, 0.9);
            border: 2px solid rgba(0, 255, 255, 0.3);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
        }

        .panel h2 {
            font-family: 'Orbitron', sans-serif;
            color: #ff00ff;
            margin-bottom: 20px;
            font-size: 18px;
            text-transform: uppercase;
        }

        .btn-add {
            background: linear-gradient(135deg, #00ff88, #00cc6f);
            color: #000;
            font-weight: 700;
            padding: 10px 20px;
        }

        .btn-add:hover {
            transform: translateY(-2px);
        }

        .btn-income {
            background: linear-gradient(135deg, #00ff88, #00cc6f);
            color: #000;
            font-weight: 700;
        }

        .btn-expense {
            background: linear-gradient(135deg, #ff0055, #cc0044);
            color: #fff;
            font-weight: 700;
        }

        .filter-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .transaction-list {
            max-height: 500px;
            overflow-y: auto;
        }

        .transaction-item {
            background: rgba(10, 14, 39, 0.6);
            border: 1px solid rgba(0, 255, 255, 0.2);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
            transition: all 0.3s;
        }

        .transaction-item:hover {
            background: rgba(0, 255, 255, 0.1);
            border-color: #00ffff;
        }

        .transaction-info {
            flex: 1;
            min-width: 200px;
        }

        .transaction-desc {
            font-weight: 700;
            font-size: 14px;
            color: #fff;
            margin-bottom: 5px;
        }

        .transaction-meta {
            font-size: 11px;
            color: #999;
        }

        .transaction-category {
            display: inline-block;
            font-size: 11px;
            color: #00ffff;
            background: rgba(0, 255, 255, 0.2);
            padding: 3px 8px;
            border-radius: 12px;
            margin-right: 8px;
        }

        .transaction-amount {
            font-family: 'Orbitron', sans-serif;
            font-size: 16px;
            font-weight: 700;
        }

        .transaction-amount.income { color: #00ff88; }
        .transaction-amount.expense { color: #ff0055; }

        .btn-delete {
            background: #ff0055;
            color: #fff;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }

        .btn-delete:hover {
            transform: scale(1.1);
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: #666;
            font-size: 14px;
        }

        .goal-item {
            background: rgba(10, 14, 39, 0.6);
            border: 1px solid rgba(0, 255, 255, 0.2);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .goal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .goal-name {
            font-family: 'Orbitron', sans-serif;
            font-size: 14px;
            color: #00ff88;
            font-weight: 700;
        }

        .progress-bar {
            width: 100%;
            height: 25px;
            background: rgba(10, 14, 39, 0.8);
            border: 1px solid rgba(0, 255, 255, 0.3);
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ffff, #ff00ff);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-weight: 700;
            font-size: 11px;
            transition: width 0.5s ease;
        }

        .achievement-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
        }

        .achievement-card {
            background: rgba(10, 14, 39, 0.6);
            border: 1px solid rgba(255, 0, 255, 0.3);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .achievement-card.unlocked {
            border-color: #ff00ff;
            background: rgba(255, 0, 255, 0.15);
        }

        .achievement-card.locked {
            opacity: 0.4;
        }

        .achievement-icon {
            font-size: 32px;
            margin-bottom: 8px;
        }

        .achievement-name {
            font-family: 'Orbitron', sans-serif;
            font-size: 11px;
            color: #00ffff;
            margin-bottom: 4px;
        }

        .chart-container {
            background: rgba(15, 25, 50, 0.9);
            border: 2px solid rgba(0, 255, 255, 0.3);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            position: relative;
            height: 300px;
        }

        .chart-container h3 {
            font-family: 'Orbitron', sans-serif;
            color: #ff00ff;
            margin-bottom: 15px;
            font-size: 14px;
            text-transform: uppercase;
        }

        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: #00ffff;
            border-radius: 50%;
            box-shadow: 0 0 10px #00ffff;
        }

        @media (max-width: 768px) {
            .login-box {
                padding: 30px;
            }

            .balance-cards {
                grid-template-columns: 1fr;
            }

            header {
                flex-direction: column;
            }

            .header-right {
                width: 100%;
                justify-content: space-between;
            }

            .tabs {
                flex-direction: column;
            }

            .transaction-item {
                flex-direction: column;
            }

            .chart-container {
                height: 250px;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>
    <div class="particles" id="particles"></div>

    <!-- LOGIN SCREEN -->
    <div class="login-screen" id="loginScreen">
        <div class="login-box">
            <h2>‚ö° NEXUS FINANCE ‚ö°</h2>
            <p class="subtitle">Secure Access Portal</p>
            
            <div class="tab-buttons">
                <button class="tab-btn active" onclick="switchLoginTab('login')">Login</button>
                <button class="tab-btn" onclick="switchLoginTab('register')">Register</button>
            </div>

            <div class="error-message" id="errorMessage"></div>
            <div class="success-message" id="successMessage"></div>

            <div id="loginForm">
                <div class="form-group">
                    <label>Username</label>
                    <input type="text" id="loginUsername" placeholder="Enter username">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="loginPassword" placeholder="Enter password">
                </div>
                <button class="btn-primary" onclick="login()">üîê LOGIN</button>
            </div>

            <div id="registerForm" style="display: none;">
                <div class="form-group">
                    <label>Username</label>
                    <input type="text" id="regUsername" placeholder="Create username">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="regPassword" placeholder="Create password">
                </div>
                <div class="form-group">
                    <label>Confirm Password</label>
                    <input type="password" id="regConfirmPassword" placeholder="Confirm password">
                </div>
                <button class="btn-primary" onclick="register()">‚ú® REGISTER</button>
            </div>
        </div>
    </div>

    <!-- MAIN APP -->
    <div class="main-app" id="mainApp">
        <div class="container">
            <header>
                <div class="header-left">
                    <h1>‚ö° NEXUS FINANCE ‚ö°</h1>
                </div>
                <div class="header-right">
                    <div class="user-info">üë§ <span id="currentUsername"></span></div>
                    <button class="btn-logout" onclick="openChangePassword()">üîë CHANGE PASSWORD</button>
                    <button class="btn-logout" onclick="logout()">üö™ LOGOUT</button>
                </div>
            </header>

            <div class="balance-cards">
                <div class="card balance">
                    <h3>‚ö° Total Balance</h3>
                    <div class="amount" id="totalBalance">Rp 0</div>
                </div>
                <div class="card income">
                    <h3>üìà Total Income</h3>
                    <div class="amount" id="totalIncome">Rp 0</div>
                </div>
                <div class="card expense">
                    <h3>üìâ Total Expense</h3>
                    <div class="amount" id="totalExpense">Rp 0</div>
                </div>
            </div>

            <div class="tabs">
                <button class="tab-link active" onclick="switchTab('transactions', this)">üí≥ Transactions</button>
                <button class="tab-link" onclick="switchTab('dashboard', this)">üìä Dashboard</button>
                <button class="tab-link" onclick="switchTab('goals', this)">üéØ Goals</button>
                <button class="tab-link" onclick="switchTab('achievements', this)">üèÜ Achievements</button>
            </div>

            <!-- DASHBOARD TAB -->
            <div id="dashboard" class="tab-content active">
                <div class="chart-container">
                    <h3>üíπ Income vs Expense</h3>
                    <canvas id="incomeExpenseChart"></canvas>
                </div>
                <div class="chart-container">
                    <h3>üìä Spending by Category</h3>
                    <canvas id="categoryChart"></canvas>
                </div>
                <div class="panel">
                    <h2>üìà Quick Stats</h2>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div style="background: rgba(0, 255, 136, 0.1); padding: 15px; border-radius: 8px;">
                            <div style="color: #00ff88; font-size: 12px; margin-bottom: 8px;">Avg Daily</div>
                            <div style="font-family: 'Orbitron'; font-size: 20px;" id="avgDaily">Rp 0</div>
                        </div>
                        <div style="background: rgba(0, 255, 255, 0.1); padding: 15px; border-radius: 8px;">
                            <div style="color: #00ffff; font-size: 12px; margin-bottom: 8px;">Total Transaksi</div>
                            <div style="font-family: 'Orbitron'; font-size: 20px;" id="totalTrans">0</div>
                        </div>
                        <div style="background: rgba(255, 0, 255, 0.1); padding: 15px; border-radius: 8px;">
                            <div style="color: #ff00ff; font-size: 12px; margin-bottom: 8px;">Top Category</div>
                            <div style="font-family: 'Orbitron'; font-size: 20px;" id="topCat">-</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TRANSACTIONS TAB -->
            <div id="transactions" class="tab-content">
                <div class="panel">
                    <h2>üî• Add Transaction</h2>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
                        <div class="form-group">
                            <label>Description</label>
                            <input type="text" id="description" placeholder="Deskripsi">
                        </div>
                        <div class="form-group">
                            <label>Amount (Rp)</label>
                            <input type="text" id="amount" placeholder="0" oninput="formatNumber(this)">
                        </div>
                        <div class="form-group">
                            <label>Category</label>
                            <select id="category">
                                <option value="">Pilih Kategori</option>
                                <option value="Uang Jajan">üí∞ Uang Jajan</option>
                                <option value="Hadiah">üéÅ Hadiah</option>
                                <option value="Uang Saku">üëõ Uang Saku</option>
                                <option value="Jual Barang">üè™ Jual Barang</option>
                                <option value="Makan & Minum">üçî Makan & Minum</option>
                                <option value="Jajanan">üç≠ Jajanan</option>
                                <option value="Transport">üöå Transport</option>
                                <option value="Buku">üìö Buku & ATK</option>
                                <option value="Tugas Sekolah">üìù Tugas Sekolah</option>
                                <option value="Pulsa">üì± Pulsa & Kuota</option>
                                <option value="Hiburan">üéÆ Hiburan</option>
                                <option value="Belanja">üõçÔ∏è Belanja</option>
                                <option value="Hobi">‚öΩ Hobi</option>
                                <option value="Sedekah">ü§≤ Sedekah</option>
                                <option value="Nabung">üè¶ Nabung</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Catatan</label>
                            <input type="text" id="notes" placeholder="Opsional">
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px;">
                        <button class="btn-income" onclick="addTransaction('income')">‚ûï INCOME</button>
                        <button class="btn-expense" onclick="addTransaction('expense')">‚ûñ EXPENSE</button>
                    </div>
                </div>

                <div class="panel">
                    <h2>üîç Filter & Search</h2>
                    <div class="filter-section">
                        <div class="form-group">
                            <label>Search</label>
                            <input type="text" id="searchInput" placeholder="Cari..." oninput="filterTrans()">
                        </div>
                        <div class="form-group">
                            <label>Kategori</label>
                            <select id="filterCat" onchange="filterTrans()">
                                <option value="">Semua</option>
                                <option value="Uang Jajan">üí∞ Uang Jajan</option>
                                <option value="Hadiah">üéÅ Hadiah</option>
                                <option value="Makan & Minum">üçî Makan</option>
                                <option value="Transport">üöå Transport</option>
                                <option value="Belanja">üõçÔ∏è Belanja</option>
                                <option value="Hiburan">üéÆ Hiburan</option>
                                <option value="Sedekah">ü§≤ Sedekah</option>
                                <option value="Nabung">üè¶ Nabung</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Tanggal</label>
                            <input type="date" id="filterDate" onchange="filterTrans()">
                        </div>
                    </div>
                </div>

                <div class="panel">
                    <h2>üìú History</h2>
                    <div class="transaction-list" id="transactionList">
                        <div class="empty-state">No transactions</div>
                    </div>
                </div>
            </div>

            <!-- GOALS TAB -->
            <div id="goals" class="tab-content">
                <div class="panel">
                    <h2>‚ûï New Goal</h2>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px;">
                        <div class="form-group">
                            <label>Goal Name</label>
                            <input type="text" id="goalName" placeholder="e.g., Beli Smartphone">
                        </div>
                        <div class="form-group">
                            <label>Target (Rp)</label>
                            <input type="text" id="goalAmount" placeholder="0" oninput="formatNumber(this)">
                        </div>
                        <div class="form-group">
                            <label>Target Date</label>
                            <input type="date" id="goalDate">
                        </div>
                    </div>
                    <button class="btn-add" onclick="addGoal()">üéØ ADD GOAL</button>
                </div>

                <div class="panel">
                    <h2>üéØ Your Goals</h2>
                    <div id="goalsList">
                        <div class="empty-state">No goals yet</div>
                    </div>
                </div>
            </div>

            <!-- ACHIEVEMENTS TAB -->
            <div id="achievements" class="tab-content">
                <div class="panel">
                    <h2 style="text-align: center; margin-bottom: 20px;">üèÜ Your Achievements</h2>
                    <div style="text-align: center; margin-bottom: 25px;">
                        <div style="font-family: 'Orbitron'; font-size: 36px; margin-bottom: 10px;" id="levelDisplay">‚≠ê Level 1</div>
                        <div style="font-size: 14px; color: #00ffff; margin-bottom: 8px;" id="streakDisplay">Streak: 0 days üî•</div>
                        <div style="font-size: 12px; color: #999;" id="xpDisplay">XP: 0</div>
                    </div>
                    
                    <div class="achievement-grid" id="achievementsList"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ========== STORAGE & DATABASE ==========
        const STORAGE_KEY = 'nexus_data';
        let database = loadStorage();
        let currentUser = null;
        let charts = {};

        function loadStorage() {
            const data = localStorage.getItem(STORAGE_KEY);
            return data ? JSON.parse(data) : { users: {} };
        }

        function saveStorage() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(database));
        }

        function getUserData(username) {
            if (!database.users[username]) {
                database.users[username] = {
                    password: '',
                    transactions: [],
                    goals: [],
                    level: 1,
                    xp: 0,
                    streak: 0
                };
            }
            return database.users[username];
        }

        // ========== UI FUNCTIONS ==========
        function switchLoginTab(tab) {
            const loginForm = document.getElementById('loginForm');
            const regForm = document.getElementById('registerForm');
            const tabs = document.querySelectorAll('.tab-btn');

            tabs.forEach(t => t.classList.remove('active'));

            if (tab === 'login') {
                loginForm.style.display = 'block';
                regForm.style.display = 'none';
                tabs[0].classList.add('active');
            } else {
                loginForm.style.display = 'none';
                regForm.style.display = 'block';
                tabs[1].classList.add('active');
            }
        }

        function switchTab(tabName, el) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-link').forEach(link => link.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            if (el) el.classList.add('active');

            if (tabName === 'dashboard') {
                setTimeout(updateCharts, 200);
            }
        }

        function showError(msg) {
            const el = document.getElementById('errorMessage');
            el.textContent = msg;
            el.style.display = 'block';
            setTimeout(() => el.style.display = 'none', 3000);
        }

        function showSuccess(msg) {
            const el = document.getElementById('successMessage');
            el.textContent = msg;
            el.style.display = 'block';
            setTimeout(() => el.style.display = 'none', 3000);
        }

        function formatNumber(input) {
            let value = input.value.replace(/\D/g, '');
            if (value) {
                value = parseInt(value).toLocaleString('id-ID');
            }
            input.value = value;
        }

        function parseNum(str) {
            return parseInt(str.replace(/\./g, '')) || 0;
        }

        function formatCur(num) {
            return 'Rp ' + num.toLocaleString('id-ID');
        }

        function formatDt(dateStr) {
            return new Date(dateStr).toLocaleDateString('id-ID', {
                day: 'numeric',
                month: 'short',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        // ========== AUTH FUNCTIONS ==========
        function register() {
            const user = document.getElementById('regUsername').value.trim();
            const pass = document.getElementById('regPassword').value;
            const conf = document.getElementById('regConfirmPassword').value;

            if (!user || !pass || !conf) {
                showError('‚ö†Ô∏è Fill all fields');
                return;
            }

            if (user.length < 3) {
                showError('‚ö†Ô∏è Username min 3 chars');
                return;
            }

            if (pass.length < 4) {
                showError('‚ö†Ô∏è Password min 4 chars');
                return;
            }

            if (pass !== conf) {
                showError('‚ö†Ô∏è Passwords not match');
                return;
            }

            if (database.users[user] && database.users[user].password) {
                showError('‚ö†Ô∏è User exists');
                return;
            }

            database.users[user] = {
                password: pass,
                transactions: [],
                goals: [],
                level: 1,
                xp: 0,
                streak: 0
            };

            saveStorage();
            showSuccess('‚úÖ Account created! Please login.');
            
            document.getElementById('regUsername').value = '';
            document.getElementById('regPassword').value = '';
            document.getElementById('regConfirmPassword').value = '';
            
            setTimeout(() => switchLoginTab('login'), 1500);
        }

        function login() {
            const user = document.getElementById('loginUsername').value.trim();
            const pass = document.getElementById('loginPassword').value;

            if (!user || !pass) {
                showError('‚ö†Ô∏è Enter username & password');
                return;
            }

            const userData = database.users[user];

            if (!userData || !userData.password) {
                showError('‚ö†Ô∏è User not found');
                return;
            }

            if (userData.password !== pass) {
                showError('‚ö†Ô∏è Wrong password');
                return;
            }

            currentUser = user;
            localStorage.setItem('currentUser', user);
            
            document.getElementById('currentUsername').textContent = user;
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            
            updateUI();
        }

        function logout() {
            if (confirm('üö™ Logout dari sistem?')) {
                currentUser = null;
                localStorage.removeItem('currentUser');
                document.getElementById('mainApp').style.display = 'none';
                document.getElementById('loginScreen').style.display = 'flex';
                
                document.getElementById('loginUsername').value = '';
                document.getElementById('loginPassword').value = '';
                document.getElementById('loginForm').style.display = 'block';
                document.getElementById('registerForm').style.display = 'none';
                document.querySelector('.tab-btn').classList.add('active');
                document.querySelectorAll('.tab-btn')[1].classList.remove('active');
                
                document.getElementById('errorMessage').style.display = 'none';
                document.getElementById('successMessage').style.display = 'none';
            }
        }

        function openChangePassword() {
            document.getElementById('changePasswordModal').style.display = 'flex';
            document.getElementById('currentPass').value = '';
            document.getElementById('newPass').value = '';
            document.getElementById('confirmNewPass').value = '';
            document.getElementById('passErrorMsg').style.display = 'none';
            document.getElementById('passSuccessMsg').style.display = 'none';
        }

        function closeChangePassword() {
            document.getElementById('changePasswordModal').style.display = 'none';
        }

        function changePassword() {
            if (!currentUser) return;

            const currentPass = document.getElementById('currentPass').value;
            const newPass = document.getElementById('newPass').value;
            const confirmPass = document.getElementById('confirmNewPass').value;

            const errMsg = document.getElementById('passErrorMsg');
            const sucMsg = document.getElementById('passSuccessMsg');

            errMsg.style.display = 'none';
            sucMsg.style.display = 'none';

            if (!currentPass || !newPass || !confirmPass) {
                errMsg.textContent = '‚ö†Ô∏è Fill all fields';
                errMsg.style.display = 'block';
                return;
            }

            const user = getUserData(currentUser);

            if (user.password !== currentPass) {
                errMsg.textContent = '‚ùå Current password wrong';
                errMsg.style.display = 'block';
                return;
            }

            if (newPass.length < 4) {
                errMsg.textContent = '‚ö†Ô∏è New password min 4 chars';
                errMsg.style.display = 'block';
                return;
            }

            if (newPass !== confirmPass) {
                errMsg.textContent = '‚ö†Ô∏è Passwords not match';
                errMsg.style.display = 'block';
                return;
            }

            user.password = newPass;
            saveStorage();

            sucMsg.textContent = '‚úÖ Password updated!';
            sucMsg.style.display = 'block';

            setTimeout(() => {
                closeChangePassword();
            }, 1500);
        }

        // Close modal when clicking outside
        window.addEventListener('click', function(e) {
            const modal = document.getElementById('changePasswordModal');
            if (e.target === modal) {
                closeChangePassword();
            }
        });

        // ========== TRANSACTION FUNCTIONS ==========
        function addTransaction(type) {
            if (!currentUser) return;

            const desc = document.getElementById('description').value.trim();
            const amt = parseNum(document.getElementById('amount').value);
            const cat = document.getElementById('category').value;
            const notes = document.getElementById('notes').value.trim();

            if (!desc || !amt || !cat) {
                alert('‚ö†Ô∏è Fill required fields');
                return;
            }

            const user = getUserData(currentUser);
            user.transactions.unshift({
                id: Date.now(),
                desc: desc,
                amount: amt,
                category: cat,
                notes: notes,
                type: type,
                date: new Date().toISOString()
            });

            user.xp += type === 'income' ? 10 : 5;
            if (type === 'income') user.streak++;
            
            checkLevel(user);
            saveStorage();
            updateUI();

            document.getElementById('description').value = '';
            document.getElementById('amount').value = '';
            document.getElementById('category').value = '';
            document.getElementById('notes').value = '';
        }

        function deleteTransaction(id) {
            if (!currentUser) return;
            const user = getUserData(currentUser);
            user.transactions = user.transactions.filter(t => t.id !== id);
            saveStorage();
            updateUI();
        }

        function filterTrans() {
            if (!currentUser) return;

            const user = getUserData(currentUser);
            const search = document.getElementById('searchInput').value.toLowerCase();
            const catFilter = document.getElementById('filterCat').value;
            const dateFilter = document.getElementById('filterDate').value;

            const filtered = user.transactions.filter(t => {
                const matchSearch = t.desc.toLowerCase().includes(search);
                const matchCat = !catFilter || t.category === catFilter;
                const matchDate = !dateFilter || new Date(t.date).toLocaleDateString() === new Date(dateFilter).toLocaleDateString();
                
                return matchSearch && matchCat && matchDate;
            });

            displayTransactions(filtered);
        }

        function displayTransactions(trans = null) {
            if (!currentUser) return;

            const user = getUserData(currentUser);
            const list = trans || user.transactions;

            const el = document.getElementById('transactionList');
            
            if (!list.length) {
                el.innerHTML = '<div class="empty-state">No transactions</div>';
                return;
            }

            el.innerHTML = list.map(t => `
                <div class="transaction-item">
                    <div class="transaction-info">
                        <div class="transaction-desc">${t.desc}</div>
                        <div class="transaction-meta">
                            <span class="transaction-category">${t.category}</span>
                            ${formatDt(t.date)}
                            ${t.notes ? ` ‚Ä¢ üìù ${t.notes}` : ''}
                        </div>
                    </div>
                    <div class="transaction-amount ${t.type}">
                        ${t.type === 'income' ? '+' : '-'} ${formatCur(t.amount)}
                    </div>
                    <button class="btn-delete" onclick="deleteTransaction(${t.id})">üóëÔ∏è</button>
                </div>
            `).join('');
        }

        // ========== GOALS FUNCTIONS ==========
        function addGoal() {
            if (!currentUser) return;

            const name = document.getElementById('goalName').value.trim();
            const amt = parseNum(document.getElementById('goalAmount').value);
            const date = document.getElementById('goalDate').value;

            if (!name || !amt || !date) {
                alert('‚ö†Ô∏è Fill all fields');
                return;
            }

            const user = getUserData(currentUser);
            user.goals.push({
                id: Date.now(),
                name: name,
                target: amt,
                date: date
            });

            saveStorage();
            updateUI();
            
            document.getElementById('goalName').value = '';
            document.getElementById('goalAmount').value = '';
            document.getElementById('goalDate').value = '';
        }

        function deleteGoal(id) {
            if (!currentUser) return;
            const user = getUserData(currentUser);
            user.goals = user.goals.filter(g => g.id !== id);
            saveStorage();
            updateUI();
        }

        function displayGoals() {
            if (!currentUser) return;

            const user = getUserData(currentUser);
            const balance = getBalance();

            const el = document.getElementById('goalsList');

            if (!user.goals.length) {
                el.innerHTML = '<div class="empty-state">No goals yet</div>';
                return;
            }

            el.innerHTML = user.goals.map(g => {
                const prog = Math.min((balance / g.target) * 100, 100);
                const days = Math.ceil((new Date(g.date) - new Date()) / (1000 * 60 * 60 * 24));

                return `
                    <div class="goal-item">
                        <div class="goal-header">
                            <div class="goal-name">${g.name}</div>
                            <button class="btn-delete" onclick="deleteGoal(${g.id})">Delete</button>
                        </div>
                        <div style="font-size: 11px; color: #999; margin-bottom: 8px;">
                            Target: ${formatCur(g.target)} ‚Ä¢ Days: ${days > 0 ? days : 'Expired'}
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${prog}%;">${prog.toFixed(0)}%</div>
                        </div>
                        <div style="font-size: 11px; color: #00ffff;">Current: ${formatCur(balance)}</div>
                    </div>
                `;
            }).join('');
        }

        // ========== ACHIEVEMENT FUNCTIONS ==========
        function checkLevel(user) {
            const newLevel = Math.floor(user.xp / 100) + 1;
            if (newLevel > user.level) {
                user.level = newLevel;
                alert(`üéâ Level ${newLevel}!`);
            }
        }

        function getAchievements(user) {
            const trans = user.transactions;
            const balance = getBalance();

            return [
                { name: 'First Step', icon: 'üë£', unlocked: trans.length >= 1, desc: 'Add 1 transaction' },
                { name: 'Saver', icon: 'üè¶', unlocked: balance > 100000, desc: 'Save Rp 100rb' },
                { name: 'Big Saver', icon: 'üíé', unlocked: balance > 1000000, desc: 'Save Rp 1jt' },
                { name: 'Consistent', icon: 'üìà', unlocked: user.streak >= 7, desc: '7 day streak' },
                { name: 'Earner', icon: 'üí∞', unlocked: trans.filter(t => t.type === 'income').length >= 10, desc: '10 incomes' },
                { name: 'Budgeter', icon: 'üìä', unlocked: user.goals.length >= 2, desc: '2 goals' }
            ];
        }

        function displayAchievements() {
            if (!currentUser) return;

            const user = getUserData(currentUser);
            const achs = getAchievements(user);

            document.getElementById('levelDisplay').textContent = `‚≠ê Level ${user.level}`;
            document.getElementById('streakDisplay').textContent = `Streak: ${user.streak} days üî•`;
            document.getElementById('xpDisplay').textContent = `XP: ${user.xp}`;

            document.getElementById('achievementsList').innerHTML = achs.map(a => `
                <div class="achievement-card ${a.unlocked ? 'unlocked' : 'locked'}">
                    <div class="achievement-icon">${a.unlocked ? a.icon : 'üîí'}</div>
                    <div class="achievement-name">${a.name}</div>
                    <div style="font-size: 10px; color: #999;">${a.desc}</div>
                </div>
            `).join('');
        }

        // ========== UTILITY FUNCTIONS ==========
        function getBalance() {
            if (!currentUser) return 0;

            const user = getUserData(currentUser);
            const income = user.transactions.filter(t => t.type === 'income').reduce((s, t) => s + t.amount, 0);
            const expense = user.transactions.filter(t => t.type === 'expense').reduce((s, t) => s + t.amount, 0);

            return income - expense;
        }

        function updateUI() {
            if (!currentUser) return;

            const user = getUserData(currentUser);
            const trans = user.transactions;
            const balance = getBalance();

            const income = trans.filter(t => t.type === 'income').reduce((s, t) => s + t.amount, 0);
            const expense = trans.filter(t => t.type === 'expense').reduce((s, t) => s + t.amount, 0);

            document.getElementById('totalBalance').textContent = formatCur(balance);
            document.getElementById('totalIncome').textContent = formatCur(income);
            document.getElementById('totalExpense').textContent = formatCur(expense);

            // Stats
            const avgDaily = expense > 0 ? Math.floor(expense / Math.max(trans.length, 1)) : 0;
            document.getElementById('avgDaily').textContent = formatCur(avgDaily);
            document.getElementById('totalTrans').textContent = trans.length;

            // Top category
            const cats = {};
            trans.forEach(t => {
                cats[t.category] = (cats[t.category] || 0) + t.amount;
            });
            const topCat = Object.entries(cats).sort((a, b) => b[1] - a[1])[0];
            document.getElementById('topCat').textContent = topCat ? topCat[0].split(' ')[0] : '-';

            displayTransactions();
            displayGoals();
            displayAchievements();
            updateCharts();
        }

        function updateCharts() {
            if (!currentUser || !document.getElementById('incomeExpenseChart').offsetParent) return;

            const user = getUserData(currentUser);
            const trans = user.transactions;

            const income = trans.filter(t => t.type === 'income').reduce((s, t) => s + t.amount, 0);
            const expense = trans.filter(t => t.type === 'expense').reduce((s, t) => s + t.amount, 0);

            // Chart 1
            if (charts.ie) charts.ie.destroy();
            charts.ie = new Chart(document.getElementById('incomeExpenseChart'), {
                type: 'bar',
                data: {
                    labels: ['Income', 'Expense'],
                    datasets: [{
                        label: 'Amount',
                        data: [income, expense],
                        backgroundColor: ['#00ff88', '#ff0055'],
                        borderColor: ['#00ff88', '#ff0055'],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { labels: { color: '#00ffff' } }
                    },
                    scales: {
                        y: {
                            ticks: { color: '#00ffff' },
                            grid: { color: 'rgba(0, 255, 255, 0.1)' }
                        },
                        x: {
                            ticks: { color: '#00ffff' },
                            grid: { color: 'rgba(0, 255, 255, 0.1)' }
                        }
                    }
                }
            });

            // Chart 2
            const cats = {};
            trans.filter(t => t.type === 'expense').forEach(t => {
                cats[t.category] = (cats[t.category] || 0) + t.amount;
            });

            if (charts.cat) charts.cat.destroy();
            charts.cat = new Chart(document.getElementById('categoryChart'), {
                type: 'doughnut',
                data: {
                    labels: Object.keys(cats),
                    datasets: [{
                        data: Object.values(cats),
                        backgroundColor: ['#00ffff', '#ff00ff', '#00ff88', '#ff0055', '#ffff00', '#00cccc', '#ff00cc', '#88ff00'],
                        borderColor: '#0a0e27',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { labels: { color: '#00ffff' } }
                    }
                }
            });
        }

        // ========== INITIALIZATION ==========
        document.addEventListener('DOMContentLoaded', function() {
            // Create particles
            const particles = document.getElementById('particles');
            for (let i = 0; i < 30; i++) {
                const p = document.createElement('div');
                p.className = 'particle';
                p.style.left = Math.random() * 100 + '%';
                p.style.top = Math.random() * 100 + '%';
                p.style.animation = `float ${Math.random() * 10 + 10}s linear infinite`;
                p.style.animationDelay = Math.random() * 5 + 's';
                particles.appendChild(p);
            }

            // Check if logged in
            const saved = localStorage.getItem('currentUser');
            if (saved && database.users[saved]) {
                currentUser = saved;
                document.getElementById('currentUsername').textContent = saved;
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('mainApp').style.display = 'block';
                updateUI();
            }

            // Enter key support
            document.getElementById('loginPassword').addEventListener('keypress', e => {
                if (e.key === 'Enter') login();
            });

            document.getElementById('regConfirmPassword').addEventListener('keypress', e => {
                if (e.key === 'Enter') register();
            });
        });
    </script>
</body>
</html>
